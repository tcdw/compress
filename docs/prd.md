# 压缩喵

「压缩喵」是一款在线 Web 小工具。

## 1. 项目概述

开发一个基于 Web 的纯前端图片压缩与缩放工具。
**核心价值：** 帮助非技术用户解决论坛/网站限制图片大小的问题。
**关键特性：** 隐私安全（所有处理在本地浏览器完成，不上传服务器）、支持超大图片（20MB+）、批量处理、实时对比。

## 2. 技术栈

*请 Agent 严格遵守以下技术栈，以保证开发效率和 Vibe：*
- **框架:** React + Repack (推荐 TypeScript)
- **UI 库:** shadcn/ui + Tailwind CSS (保证现代简洁的 UI 风格)
- **图标:** Lucide React
- **核心逻辑库:**
  - `jszip`: 用于打包生成 Zip。
  - `file-saver`: 用于触发下载。
  - `react-compare-slider`: 用于实现“处理前 vs 处理后”的滑块对比效果。

为了防止阻塞主线程导致界面卡顿，请使用 OffscreenCanvas + Web Worker 进行图片的处理操作。

## 3. 功能需求

### 3.1 图片导入

- 支持拖拽上传 (Drag & Drop) 和点击按钮选择文件。
- 支持批量选择（多选）。
- **格式限制:** JPG, PNG, WebP。

### 3.2 全局设置

用户可以在设置区域配置适用于所有图片的参数：
1.  **压缩质量 (Quality):** 滑块 (0.1 - 1.0)，默认 0.8。
2.  **最大宽度 (Max Width):** 输入框（像素 px）。
    - *逻辑:* 如果图片原始宽度大于此值，则缩小至此宽度并保持长宽比；如果原始宽度小于此值，保持原样（不放大）。
    - *预设:* 提供几个常见论坛预设 (e.g., 800px, 1200px, 1920px)。

### 3.3 图片列表与预览

- 导入后，图片以网格形式展示缩略图。
- 每张卡片显示：文件名、原始大小 (e.g., 20MB)。
- **实时预览:** 后台自动根据当前设置预处理一张缩略图，计算并显示“预计压缩后大小” (e.g., 20MB -> 1.5MB)。

### 3.4 详细对比模式

- 点击任意一张图片，打开模态框 (Modal)。
- **对比组件:** 使用“左/右滑块” (Before/After slider) 覆盖在图片上。
  - 左侧显示原图，右侧显示压缩后的图。
  - 方便用户检查文字是否模糊、细节是否丢失。

### 3.5 导出与保存

- **方案 A (通用):** 点击“全部处理并下载”，将所有处理后的图片打包成 `.zip` 文件下载。
- **方案 B (Chrome/Edge 增强):** 利用 `File System Access API` (`showDirectoryPicker`)。
  - 允许用户选择本地的一个文件夹。
  - 直接将处理后的图片写入该文件夹，无需解压 Zip。
  - *提示:* 如果浏览器不支持此 API，自动回退到方案 A。

## 4. UI/UX 流程与布局 (User Flow & Layout)

**布局建议:**
- **左侧 (或顶部) 控制栏:** 放置“质量滑块”、“最大宽度输入”、“导出按钮”。
- **右侧 (或主区域) 内容区:**
  - **空状态:** 一个大大的、带有微交互动画的虚线框，提示“拖入图片”。
  - **有数据状态:** 响应式网格布局 (Grid)，展示图片卡片。

**交互细节:**
- **加载状态:** 处理大图片（20MB）可能需要时间，每张图片卡片上需要有 Loading 圈或进度条。
- **反馈:** 压缩完成后，用绿色文字高亮显示节省了多少体积 (e.g., "-92%")。

## 5. 边缘情况 (Edge Cases)

- **非图片文件:** 过滤掉并提示错误。
- **极大图片 (e.g. 100MB):** 浏览器可能会卡顿，需要使用 Web Worker (如果 Agent 能做的话) 或者在 UI 上提示“正在努力处理中...”。
- **0 宽度:** 如果用户输入宽度为空或 0，则仅压缩质量，不改变尺寸。
